<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>GPU and Canvas bug in Google Chrome (Windows) | Владимир Макушев. Блог.</title>
  <meta name="author" content="Владимир Макушев">
  
  <meta name="description" content="Простыми словами о трудовых буднях, хобби, увлечениях.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="GPU and Canvas bug in Google Chrome (Windows)"/>
  <meta property="og:site_name" content="Владимир Макушев. Блог."/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Владимир Макушев. Блог." type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Владимир Макушев. Блог.</a></h1>
  <h2><a href="/">Простыми словами о фронтенде, айти и жизни.</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-12-02T13:16:28.000Z"><a href="/2015/12/02/gpu-canvas-bug-google-chrome-windows-eng/">2 December 2015</a></time>
      
      
  
    <h1 class="title">GPU and Canvas bug in Google Chrome (Windows)</h1>
  

    </header>
    <div class="entry">
      
        <p>Today I was working on unusual and hence interesting task. The team manager reported about strange “Aw’ Snap!” Google Chrome message on a particular page. Have to say, that page has a gallery, map and Google Street View. I couldn’t reproduce this bug on my machine, and now I’m going to describe what we did to handle this issue.<br><a id="more"></a><br>First we made a plan to reproduce this bug and get “Aw’ snap!” message. All you need to do is open the page and refresh it (or come back to this page later). That’s all, Chrome’s tab dies instantly.</p>
<p>We understood that bug reproduces in Windows only. I work on Mac, but as I wrote before, have <a href="/2015/05/25/ie-mac-testing/">virtual machines for any case</a>. But even on a VM this issue was not reproduces. By the way, this is a good example of Virtual Machine inability to reproduce “live” hardware machine.</p>
<p>I started googling the issue and everything I’ve googled is “How to enable logging” in Chrome. I wanted to understand why Chrome crashed and what happened when It said “Aw’ Snap!”. So, to enable logging I run Chrome with flag:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--enable-logging --v=1</span><br></pre></td></tr></table></figure></p>
<p>And then, after it crashes, log <strong><em>chrome_debug.log</em></strong> file is created in UserData directory.</p>
<p>I did so. And started to inspect the log:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[7924:5320:1202/135210:VERBOSE1:policy_loader_win.cc(441)] Reading policy from the registry is enabled.</span><br><span class="line">[7924:5320:1202/135210:VERBOSE1:pref_proxy_config_tracker_impl.cc(216)] 03885C38: set chrome proxy config service to 00A097F8</span><br><span class="line">[7924:5320:1202/135210:VERBOSE1:pref_proxy_config_tracker_impl.cc(354)] 03885C38: Done pushing proxy to UpdateProxyConfig</span><br><span class="line">[7924:6044:1202/135210:VERBOSE1:multi_log_ct_verifier.cc(67)] Adding CT log: Google &apos;Pilot&apos; log</span><br><span class="line">[7924:6044:1202/135210:VERBOSE1:multi_log_ct_verifier.cc(67)] Adding CT log: Google &apos;Aviator&apos; log</span><br><span class="line">[7924:6044:1202/135210:VERBOSE1:multi_log_ct_verifier.cc(67)] Adding CT log: DigiCert Log Server</span><br><span class="line">[7924:6044:1202/135210:VERBOSE1:multi_log_ct_verifier.cc(67)] Adding CT log: Google &apos;Rocketeer&apos; log</span><br><span class="line">[7924:6044:1202/135210:VERBOSE1:multi_log_ct_verifier.cc(67)] Adding CT log: Certly.IO log</span><br><span class="line">[7924:6044:1202/135210:VERBOSE1:multi_log_ct_verifier.cc(67)] Adding CT log: Izenpe log</span><br><span class="line">[7924:6044:1202/135210:VERBOSE1:multi_log_ct_verifier.cc(67)] Adding CT log: Symantec log</span><br><span class="line">[7924:6044:1202/135210:ERROR:cache_util_win.cc(20)] Unable to move the cache: 5</span><br><span class="line">[7924:6044:1202/135210:ERROR:cache_util.cc(132)] Unable to move cache folder C:\Users\User32\AppData\Local\Google\Chrome\User Data\ShaderCache\GPUCache to C:\Users\User32\AppData\Local\Google\Chrome\User Data\ShaderCache\old_GPUCache_000</span><br><span class="line">[7924:6044:1202/135210:ERROR:cache_creator.cc(132)] Unable to create cache</span><br><span class="line">[7924:6044:1202/135210:ERROR:shader_disk_cache.cc(588)] Shader Cache Creation failed: -2</span><br></pre></td></tr></table></figure></p>
<p>I noticed, surely, last 4 strings. Obviously, browser for some reason couldn’t copy/move a <strong><em>GPUCache</em></strong> directory. I can’t really say that I understand how Chrome works with GPU and its cache, but talking about Windows and GPU is a popular subject last weeks.</p>
<p>Further, switching maps and Street View, I found that problem is Street View. I created an Issue about it on Chromium.</p>
<h2 id="Instead-of-outcome"><a href="#Instead-of-outcome" class="headerlink" title="Instead of outcome"></a>Instead of outcome</h2><p>I created an isolated example to reproduce this bug. <a href="http://jsfiddle.net/7jm16rq7/" target="_blank" rel="noopener">JSFiddle</a>.<br>Follow the link and after you see Street View image, refresh the page. Just to remember, you must have Windows as OS and Google Chrome (46.0.2490.86).</p>
<h3 id="Полезные-ссылки"><a href="#Полезные-ссылки" class="headerlink" title="Полезные ссылки"></a>Полезные ссылки</h3><p><a href="http://www.chromium.org/for-testers/enable-logging" target="_blank" rel="noopener">How to enable logging in Google Chrome</a><br><a href="https://code.google.com/p/chromium/issues/detail?id=564613" target="_blank" rel="noopener">Issue in Chromium</a></p>
<p><strong><em>Update</em></strong> This issue fixed in stable 47.</p>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/English/">English</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/google-chrome/">google chrome</a>, <a href="/tags/bug/">bug</a>, <a href="/tags/issue/">issue</a>, <a href="/tags/gpu/">gpu</a>, <a href="/tags/canvas/">canvas</a>, <a href="/tags/windows/">windows</a>, <a href="/tags/log/">log</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">Комментарии</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=907270236144918";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="http://blog.makushev.com/2015/12/02/gpu-canvas-bug-google-chrome-windows-eng/index.html" data-num-posts="5" data-width="840" data-colorscheme="light"></div>
      
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Поиск">
    <input type="hidden" name="q" value="site:blog.makushev.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Категории</h3>
  <ul class="entry">
  
    <li><a href="/categories/English/">English</a><small>2</small></li>
  
    <li><a href="/categories/Русский/">Русский</a><small>16</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Метки</h3>
  <ul class="entry">
  
    <li><a href="/tags/Destructuring/">Destructuring</a><small>1</small></li>
  
    <li><a href="/tags/Dispatcher/">Dispatcher</a><small>2</small></li>
  
    <li><a href="/tags/ES2015-ES6/">ES2015/ES6</a><small>3</small></li>
  
    <li><a href="/tags/IE/">IE</a><small>1</small></li>
  
    <li><a href="/tags/Mac/">Mac</a><small>1</small></li>
  
    <li><a href="/tags/Mediator/">Mediator</a><small>2</small></li>
  
    <li><a href="/tags/Object-create/">Object.create</a><small>1</small></li>
  
    <li><a href="/tags/Observer/">Observer</a><small>1</small></li>
  
    <li><a href="/tags/Pub-Sub/">Pub/Sub</a><small>1</small></li>
  
    <li><a href="/tags/Template-strings/">Template strings</a><small>1</small></li>
  
    <li><a href="/tags/VirtualBox/">VirtualBox</a><small>1</small></li>
  
    <li><a href="/tags/arrow-functions/">arrow functions</a><small>1</small></li>
  
    <li><a href="/tags/blocking-I-O/">blocking I/O</a><small>1</small></li>
  
    <li><a href="/tags/bug/">bug</a><small>2</small></li>
  
    <li><a href="/tags/canvas/">canvas</a><small>2</small></li>
  
    <li><a href="/tags/css/">css</a><small>1</small></li>
  
    <li><a href="/tags/digitalocean/">digitalocean</a><small>2</small></li>
  
    <li><a href="/tags/event-driven/">event-driven</a><small>1</small></li>
  
    <li><a href="/tags/git/">git</a><small>1</small></li>
  
    <li><a href="/tags/google-chrome/">google chrome</a><small>2</small></li>
  
    <li><a href="/tags/gpu/">gpu</a><small>2</small></li>
  
    <li><a href="/tags/issue/">issue</a><small>2</small></li>
  
    <li><a href="/tags/javascript/">javascript</a><small>1</small></li>
  
    <li><a href="/tags/link/">link</a><small>2</small></li>
  
    <li><a href="/tags/log/">log</a><small>2</small></li>
  
    <li><a href="/tags/momondo/">momondo</a><small>1</small></li>
  
    <li><a href="/tags/node-js/">node.js</a><small>1</small></li>
  
    <li><a href="/tags/non-blocking-I-O/">non-blocking I/O</a><small>1</small></li>
  
    <li><a href="/tags/prototype/">prototype</a><small>1</small></li>
  
    <li><a href="/tags/referral/">referral</a><small>2</small></li>
  
    <li><a href="/tags/w3c/">w3c</a><small>1</small></li>
  
    <li><a href="/tags/windows/">windows</a><small>2</small></li>
  
    <li><a href="/tags/Деструктуризация/">Деструктуризация</a><small>1</small></li>
  
    <li><a href="/tags/Наследование/">Наследование</a><small>1</small></li>
  
    <li><a href="/tags/Паттерны/">Паттерны</a><small>5</small></li>
  
    <li><a href="/tags/Шаблонные-строки/">Шаблонные строки</a><small>1</small></li>
  
    <li><a href="/tags/авиабилеты/">авиабилеты</a><small>1</small></li>
  
    <li><a href="/tags/исследование/">исследование</a><small>1</small></li>
  
    <li><a href="/tags/литература/">литература</a><small>2</small></li>
  
    <li><a href="/tags/обучение/">обучение</a><small>1</small></li>
  
    <li><a href="/tags/саморазвитие/">саморазвитие</a><small>1</small></li>
  
    <li><a href="/tags/сила-воли/">сила воли</a><small>1</small></li>
  
    <li><a href="/tags/стрелочные-функции/">стрелочные функции</a><small>1</small></li>
  
    <li><a href="/tags/экономия/">экономия</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2018 Владимир Макушев
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter30607982 = new Ya.Metrika({id:30607982,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/30607982" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
</body>
</html>